<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Block SuperCollider</title>
		<link rel="icon" type="image/png" href="lib/jssc3/png/os.512.png" />
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/aaaakshat/cm-web-fonts@latest/fonts.css" />
		<link rel="stylesheet" type="text/css" media="all" href="css/blksc3.css" />
		<script src="lib/blockly-9.1.0/blockly_compressed.js"></script>
		<script src="lib/blockly-9.1.0/javascript_compressed.js"></script>
		<script src="lib/blockly-9.1.0/msg/en.js"></script>
		<script src="lib/blockly-9.1.0/blocks_compressed.js"></script>
		<script src="lib/commonmark.js/dist/commonmark.js"></script>
		<script src="lib/osc.js/dist/osc-browser.js"></script>
		<script type="module">
import * as sc from './lib/jssc3/dist/jssc3.js'
import * as sl from './lib/spl/dist/sl.js'
import * as blk from './js/blksc3.js'
globalThis.sc = sc;
globalThis.sl = sl;
globalThis.blk = blk;
sl.addLoadUrlMethods();
window.onload = function() {
	sc.sc3_wasm_init(sc.setter_for_inner_html_of('statusText'));
	sc.sc3_mouse_init(globalScsynth);
	sl.assignGlobals();
	sl.loadUrlArrayInSequence('lib/spl/sl', ['kernel.sl', 'std.sl', 'lib/sc.sl']);
	globalThis.rec = blk.init(Blockly, false, false);
};
		</script>
	</head>
	<body>
		<div id="blocklyContainer"></div>
		<div id="blkEdit">
			<div id="blkMenu">
				<select id="programMenu" title="Program (p)" accesskey="p"></select>
				<select id="helpMenu" title="Help (h)" accesskey="h"></select>
				<select id="guideMenu" title="Guide (g)" accesskey="g"></select>
				<select id="smallProgramsMenu" title="Small Programs (a)" accesskey="a"></select>
				<select id="userMenu" title="User (u)" accesskey="u"><option value=''>--User--</option></select>
				<select id="actionsMenu" title="Actions">
					<option value=''>&#x2630;</option>
					<option value='userBackup'>Backup</option>
					<option value='userRestore'>Restore</option>
					<option value='userPurge'>Purge</option>
				</select>
			</div>
			<div id="blkCmd">
				<input type="file" id="xmlInputFile" accept=".xml" onchange="blk.read_input_xml('xmlInputFile', rec)" style="display:none">
				<input type="file" id="userProgramArchiveFile" accept=".json" onchange="sc.user_program_read_archive('userProgramArchiveFile', 'userMenu')" style="display:none">
				<button id="xmlInputFileSelect" title="Select and load .xml file to workspace (l)" accesskey="l">Load</button>
				<button title="Copy workspace xml to clipboard (c)"  accesskey="c" onclick="navigator.clipboard.writeText(blk.workspaceXml(rec))">Copy</button>
				<button title="Cleanup workspace (o)" accesskey="o" onclick="rec.workspace.cleanUp()">Cleanup</button>
				<!-- <button title="Center drawing in workspace" onclick="rec.workspace.scrollCenter()">Center</button> -->
				<button title="Fit drawing to workspace (=)" accesskey="=" onclick="rec.workspace.zoomToFit()">Fit</button>
				<button title="Print" onclick="blk.print_code(rec)">Print</button>
				<button title="Evaluate workspace program (/)" accesskey="/" onclick="blk.eval_code(rec)">Eval</button>
				<button title="Play workspace program (,)" accesskey="," onclick="blk.play_code(rec)">Play</button>
				<button title="Send reset command (.)" accesskey="." onclick="sc.resetScsynth(globalScsynth)">Reset</button>
				<button title="Delete all blocks from workspace (k)" accesskey="k" onclick="rec.workspace.clear()">Clear</button>
				<button title="Save document to local storage (s)" accesskey="s" onclick="sc.user_program_save_to('userMenu', blk.workspaceXml(rec), false)">Save</button>
				<select id="blkLayoutMenu" title="System layouts (y)" accesskey="y">
					<option value=''>--Display--</option>
					<option value='%×%'>%×%</option>
					<option value='1366×768'>1366×768</option>
					<option value='1440×900'>1440×900</option>
					<option value='1680×1050'>1680×1050</option>
					<option value='1920×1080'>1920×1080</option>
				</select>
				<button title="Begin" accesskey="b" onclick="globalScsynth.boot()">Begin</button>
<!--
				ⓘ
-->
				<span id="statusText">...</span>
				<button title="Fullscreen" accesskey="x" onclick="sc.fullscreen()">⇱</button>
			</div>
		</div>

		<div id="blkCtl">
			<details open>
				<summary>Notes</summary>
				<div id="blkNotes">
					<h2>Block SuperCollider</h2>
					<p><em>blksc3</em> is a visual editor for SuperCollider.</p>
					<p>There is a <em>Guide</em>, the menu is below the workspace.</p>
					<p>If the <em>status area</em> says <em>Loading...</em> please wait.</p>
				</div>
			</details>
<!--
			<div id="uiCtlContainer"></div>
-->
		</div>
		<script async src="lib/scsynth-wasm-builds/ext/scsynth.js"></script>
	</body>
</html>

<!--
<button title="Copy current workspace Svg to clipboard" onclick="navigator.clipboard.writeText(blk.get_svg())">Copy Svg</button>
-->
